{"version":3,"names":["_react","require","_ensureUnit","_interopRequireDefault","_getMostRecentQuantitySample","_subscribeToChanges","e","__esModule","default","useMostRecentQuantitySample","identifier","unit","lastSample","setLastSample","useState","useEffect","cancelSubscription","init","actualUnit","ensureUnit","value","getMostRecentQuantitySample","subscribeToChanges","_cancelSubscription","_default","exports"],"sources":["useMostRecentQuantitySample.ts"],"sourcesContent":["import { useEffect, useState } from 'react'\n\nimport ensureUnit from '../utils/ensureUnit'\nimport getMostRecentQuantitySample from '../utils/getMostRecentQuantitySample'\nimport subscribeToChanges from '../utils/subscribeToChanges'\n\nimport type { HKQuantityTypeIdentifier, UnitForIdentifier } from '../native-types'\nimport type { HKQuantitySample } from '../types'\n\n/**\n   * @returns the most recent sample for the given quantity type.\n   */\nfunction useMostRecentQuantitySample<\n  TIdentifier extends HKQuantityTypeIdentifier,\n  TUnit extends UnitForIdentifier<TIdentifier>\n>(identifier: TIdentifier, unit?: TUnit) {\n  const [lastSample, setLastSample] = useState<HKQuantitySample<\n  TIdentifier\n  > | null>(null)\n\n  useEffect(() => {\n    let cancelSubscription: (() => Promise<boolean>) | undefined\n\n    const init = async () => {\n      const actualUnit = await ensureUnit(identifier, unit)\n\n      const value = await getMostRecentQuantitySample(identifier, actualUnit)\n      setLastSample(value)\n\n      cancelSubscription = await subscribeToChanges(identifier, async () => {\n        const value = await getMostRecentQuantitySample(identifier, actualUnit)\n        setLastSample(value)\n      })\n    }\n    void init()\n\n    return () => {\n      void cancelSubscription?.()\n    }\n  }, [identifier, unit])\n\n  return lastSample\n}\n\nexport default useMostRecentQuantitySample\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,OAAA;AAEA,IAAAC,WAAA,GAAAC,sBAAA,CAAAF,OAAA;AACA,IAAAG,4BAAA,GAAAD,sBAAA,CAAAF,OAAA;AACA,IAAAI,mBAAA,GAAAF,sBAAA,CAAAF,OAAA;AAA4D,SAAAE,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAK5D;AACA;AACA;AACA,SAASG,2BAA2BA,CAGlCC,UAAuB,EAAEC,IAAY,EAAE;EACvC,MAAM,CAACC,UAAU,EAAEC,aAAa,CAAC,GAAG,IAAAC,eAAQ,EAElC,IAAI,CAAC;EAEf,IAAAC,gBAAS,EAAC,MAAM;IACd,IAAIC,kBAAwD;IAE5D,MAAMC,IAAI,GAAG,MAAAA,CAAA,KAAY;MACvB,MAAMC,UAAU,GAAG,MAAM,IAAAC,mBAAU,EAACT,UAAU,EAAEC,IAAI,CAAC;MAErD,MAAMS,KAAK,GAAG,MAAM,IAAAC,oCAA2B,EAACX,UAAU,EAAEQ,UAAU,CAAC;MACvEL,aAAa,CAACO,KAAK,CAAC;MAEpBJ,kBAAkB,GAAG,MAAM,IAAAM,2BAAkB,EAACZ,UAAU,EAAE,YAAY;QACpE,MAAMU,KAAK,GAAG,MAAM,IAAAC,oCAA2B,EAACX,UAAU,EAAEQ,UAAU,CAAC;QACvEL,aAAa,CAACO,KAAK,CAAC;MACtB,CAAC,CAAC;IACJ,CAAC;IACD,KAAKH,IAAI,CAAC,CAAC;IAEX,OAAO,MAAM;MAAA,IAAAM,mBAAA;MACX,OAAAA,mBAAA,GAAKP,kBAAkB,cAAAO,mBAAA,uBAAlBA,mBAAA,CAAqB,CAAC;IAC7B,CAAC;EACH,CAAC,EAAE,CAACb,UAAU,EAAEC,IAAI,CAAC,CAAC;EAEtB,OAAOC,UAAU;AACnB;AAAC,IAAAY,QAAA,GAAAC,OAAA,CAAAjB,OAAA,GAEcC,2BAA2B","ignoreList":[]}